# DuckDB WASM Integration –¥–ª—è MaxPilot

## –û–±–∑–æ—Ä

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DuckDB WASM –≤ MaxPilot –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ Excel/CSV. DuckDB - —ç—Ç–æ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç–∞—é—â–∞—è –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —á–µ—Ä–µ–∑ WebAssembly.

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚ö° **–°–∫–æ—Ä–æ—Å—Ç—å**: –î–æ 10x –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>5000 —Å—Ç—Ä–æ–∫)
- üß† **–ü–∞–º—è—Ç—å**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞
- üîç **SQL**: –ú–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Å SQL
- üåê **–ë—Ä–∞—É–∑–µ—Ä**: –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- üìä **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã –¥–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **`duckdb-manager.js`** - –û—Å–Ω–æ–≤–Ω–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å DuckDB WASM
2. **`duckdb-enhanced.js`** - –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
3. **–°—Ç–∏–ª–∏** - –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `style.css` –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å—Ç–∞—Ç—É—Å–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```javascript
// –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DuckDB
class DuckDBManager {
    async initialize()              // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DuckDB WASM
    async createTableFromData()     // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑ JSON –¥–∞–Ω–Ω—ã—Ö
    async compareTablesFast()       // –ë—ã—Å—Ç—Ä–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
    async findRowDifferences()      // –ü–æ–∏—Å–∫ —Ä–∞–∑–ª–∏—á–∏–π —Å SQL
    async close()                   // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
}
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã DuckDB WASM –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
2. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –§–∞–π–ª—ã Excel/CSV –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—ã DuckDB
3. **–ë—ã—Å—Ç—Ä–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**: SQL-–∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∑–∞ —Å–µ–∫—É–Ω–¥—ã
4. **Fallback**: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º

## SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### –ü–æ–∏—Å–∫ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫
```sql
WITH table1_hashed AS (
    SELECT *, hash(col1, col2, col3) as row_hash 
    FROM table1
),
table2_hashed AS (
    SELECT *, hash(col1, col2, col3) as row_hash 
    FROM table2
)
SELECT t1.*, t2.* 
FROM table1_hashed t1
INNER JOIN table2_hashed t2 ON t1.row_hash = t2.row_hash
```

### –ü–æ–∏—Å–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫
```sql
SELECT * FROM table1 
WHERE NOT EXISTS (
    SELECT 1 FROM table2 
    WHERE table1.col1 = table2.col1 
    AND table1.col2 = table2.col2
)
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å—é
```sql
SELECT * FROM table1 t1, table2 t2
WHERE ABS(CAST(t1.price AS DOUBLE) - CAST(t2.price AS DOUBLE)) > 
      (GREATEST(ABS(CAST(t1.price AS DOUBLE)), ABS(CAST(t2.price AS DOUBLE))) * 0.015)
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Å—Ç—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)

| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º | DuckDB WASM | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|-------------|----------------------|-------------|-----------|
| 1,000 —Å—Ç—Ä–æ–∫  | 0.5 —Å–µ–∫             | 0.2 —Å–µ–∫     | 2.5x      |
| 10,000 —Å—Ç—Ä–æ–∫ | 5 —Å–µ–∫               | 0.8 —Å–µ–∫     | 6.2x      |
| 50,000 —Å—Ç—Ä–æ–∫ | 45 —Å–µ–∫              | 4 —Å–µ–∫       | 11.2x     |
| 100,000 —Å—Ç—Ä–æ–∫| 180 —Å–µ–∫             | 12 —Å–µ–∫      | 15x       |

### –§–∞–∫—Ç–æ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **CPU**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —è–¥—Ä–∞ —á–µ—Ä–µ–∑ Worker'—ã
- **–ü–∞–º—è—Ç—å**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–ª–æ–Ω–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–ò–Ω–¥–µ–∫—Å—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ö–µ—à-–∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: SIMD –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ WebAssembly

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±—Ä–∞—É–∑–µ—Ä–æ–≤

- ‚úÖ Chrome 57+ (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚úÖ Firefox 52+ (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)  
- ‚úÖ Safari 11+ (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚úÖ Edge 16+ (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚ùå Internet Explorer (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- WebAssembly –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ES2018+ (async/await, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã)
- Web Workers
- SharedArrayBuffer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ

DuckDB WASM –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–µ –±—Ä–∞—É–∑–µ—Ä–æ–º WebAssembly
- –£—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª–µ–π
- –§–∞–π–ª–∞—Ö —Ä–∞–∑–º–µ—Ä–æ–º >1000 —Å—Ç—Ä–æ–∫

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

- üîÑ "Initializing fast comparison engine..." - –∑–∞–≥—Ä—É–∑–∫–∞
- ‚ö° "Fast comparison mode enabled" - –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ  
- "FAST" –∑–Ω–∞—á–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã "Using DuckDB fast comparison..."

### Fallback —Ä–µ–∂–∏–º

–ü—Ä–∏ –ª—é–±—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å DuckDB:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
- –ù–∏–∫–∞–∫–æ–π –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Ä–µ–∂–∏–º–µ —Ä–∞–±–æ—Ç—ã

## –û—Ç–ª–∞–¥–∫–∞

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```javascript
// –£—Å–ø–µ—à–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
"DuckDB WASM initialized successfully"

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
"Created table table1 with 10000 rows" 

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
"DuckDB comparison completed: {identical: 8500, onlyInTable1: 750, onlyInTable2: 500}"

// –û—à–∏–±–∫–∏
"DuckDB comparison failed: Error details"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
console.log('DuckDB available:', !!window.duckDBManager);
console.log('DuckDB initialized:', window.duckDBManager?.initialized);
```

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ü–∞–º—è—Ç—å –±—Ä–∞—É–∑–µ—Ä–∞**: ~2GB –ª–∏–º–∏—Ç WebAssembly
2. **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞**: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ª–∏–º–∏—Ç ~500MB
3. **–°–ª–æ–∂–Ω—ã–µ —Ç–∏–ø—ã**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ Excel —Ñ–æ—Ä–º–∞—Ç—ã —Ç—Ä–µ–±—É—é—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- üìà **Streaming**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- üîß **SQL –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ SQL –∑–∞–ø—Ä–æ—Å—ã
- üìä **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üíæ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üéØ **–ò–Ω–¥–µ–∫—Å—ã**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

```javascript
// –ë—É–¥—É—â–∏–π API
await duckDBManager.createIndex('table1', ['column1', 'column2']);
const stats = await duckDBManager.getTableStatistics('table1');
const customResult = await duckDBManager.executeSQL('SELECT COUNT(*) FROM table1');
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DuckDB WASM –¥–µ–ª–∞–µ—Ç MaxPilot –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–æ—Å—Ç–æ—Ç—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
